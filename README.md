
## ç›®å½•

- [å†™ä½œèƒŒæ™¯](#å†™ä½œèƒŒæ™¯)
- [å†™ä½œç›®æ ‡](#å†™ä½œç›®æ ‡)
- [é¡¹ç›®å®‰è£…](#é¡¹ç›®å®‰è£…)
  + [åˆæ¬¡å°è¯•](#åˆæ¬¡å°è¯•)
  + [åˆæ¬¡å›é¡¾](#åˆæ¬¡å›é¡¾)
  + [ä¾èµ–åŒ…æ‹“å±•](#ä¾èµ–åŒ…æ‹“å±•)
- [é¡¹ç›®è°ƒæ•´](#ç»“æ„è°ƒæ•´)
  + [åˆæ­¥æ€è€ƒ](#åˆæ¬¡å›é¡¾)
  + [redux-sagaåˆ¨å‘](#redux-sagaåˆ¨å‘)
  + [å¼•å…¥cssæ¨¡å—æœºåˆ¶](#å¼•å…¥cssæ¨¡å—æœºåˆ¶)
  + [TypeScriptçš„åæ€](#TypeScriptçš„åæ€)


## å†™ä½œèƒŒæ™¯

JavaScript æ˜¯ä¸€ç§è½»é‡çº§çš„è§£é‡Šæ€§è„šæœ¬è¯­è¨€ï¼Œå¯åµŒå…¥åˆ° HTML é¡µé¢ä¸­ï¼Œåœ¨æµè§ˆå™¨ç«¯æ‰§è¡Œï¼Œèƒ½å¤Ÿå®ç°æµè§ˆå™¨ç«¯ä¸°å¯Œçš„äº¤äº’åŠŸèƒ½ï¼Œä¸ºç”¨æˆ·å¸¦æ¥æµç•…å¤šæ ·çš„ç”¨æˆ·ä½“éªŒã€‚JavaScript æ˜¯åŸºäºå¯¹è±¡å’Œäº‹ä»¶é©±åŠ¨çš„ï¼Œæ— éœ€ç‰¹å®šçš„è¯­è¨€ç¯å¢ƒï¼Œåªéœ€åœ¨æ”¯æŒçš„æµè§ˆå™¨ä¸Šå°±èƒ½è¿è¡Œã€‚

TypeScript æ˜¯ Microsoft å¼€å‘å’Œç»´æŠ¤çš„ä¸€ç§é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ã€‚å®ƒæ˜¯ JavaScript çš„è¶…é›†ï¼ŒåŒ…å«äº† JavaScript çš„æ‰€æœ‰å…ƒç´ ï¼Œå¯ä»¥è½½å…¥ JavaScript ä»£ç è¿è¡Œï¼Œå¹¶æ‰©å±•äº† JavaScript çš„è¯­æ³•ã€‚

TypeScript å¯ä»¥ä½¿ç”¨ JavaScript ä¸­çš„æ‰€æœ‰ä»£ç å’Œç¼–ç æ¦‚å¿µï¼ŒTypeScript æ˜¯ä¸ºäº†ä½¿ JavaScript çš„å¼€å‘å˜å¾—æ›´åŠ å®¹æ˜“è€Œåˆ›å»ºçš„ã€‚å°¤å…¶æ˜¯ç±»å‹å’Œæ¥å£ç­‰æ¦‚å¿µæè¿°æ­£åœ¨ä½¿ç”¨çš„æ•°æ®ï¼Œå¯¹äºå¼±ç±»å‹è¯­è¨€è¿›è¡Œäº†å¼¥è¡¥ï¼Œå¯è°“ä½¿å¾—ä½¿å¾—ç¼–è¯‘åçš„javascriptå¦‚é±¼å¾—æ°´ã€‚TypeScript å¼•å…¥äº† JavaScript ä¸­æ²¡æœ‰çš„â€œç±»â€æ¦‚å¿µã€‚TypeScript ä¸­å¼•å…¥äº†æ¨¡å—çš„æ¦‚å¿µï¼Œå¯ä»¥æŠŠå£°æ˜ã€æ•°æ®ã€å‡½æ•°å’Œç±»å°è£…åœ¨æ¨¡å—ä¸­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡äºŒè€…ç»“åˆå†™å‡ºæ›´åŠ å¥å£®çš„ä»£ç ï¼Œå¢å¼ºäº†ç”Ÿäº§åŠ›ã€‚

## å†™ä½œç›®çš„

- è§£å†³éƒ¨åˆ†å‰ç«¯åŒå­¦é‡å¤æ„å»ºåŸºç¡€æ¨¡å—çš„é—®é¢˜ï¼Œè§£æ”¾éƒ¨åˆ†ç”Ÿäº§åŠ›

- ç»“åˆæœ€æ–°çš„reactå…¨å®¶æ¡¶å’ŒTypeScriptï¼Œè¿›è¡Œé¡¹ç›®æ¨¡æ¿çš„æ„å»ºï¼Œè®©æ¨¡å—åŒ–çš„å¾—åˆ°è´¨çš„æå‡

- äº§å‡ºä¸€ä¸ªåŸºäºreactè„šæ‰‹æ¶é€šç”¨é¡¹ç›®æ¶æ„æ¨¡æ¿ï¼Œå½“ç„¶ä½ å¯ä»¥ç»“åˆè‡ªå·±çš„æƒ…å†µè¿›è¡Œç®€å•ä¿®æ”¹


## é¡¹ç›®å®‰è£…

é¦–å…ˆä½ è¦ç¡®ä¿è‡ªå·±çš„ç”µè„‘å®‰è£…äº†nodeçš„ç¨³å®šç‰ˆæœ¬ï¼Œæ²¡æœ‰å®‰è£…çš„å¯ä»¥ [ç§»æ­¥è¿™é‡Œ](https://nodejs.org/en/)ï¼ŒæŒ‰ç…§æ–‡æ¡£è‡ªè¡Œå®‰è£…ï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```sh
npm install -g create-react-app
```

ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„é¡¹ç›®

 ```sh
 create-react-app react-ts-template --scripts-version=react-scripts-ts
 ```
 
 åˆ›å»ºæˆåŠŸåï¼Œé¡¹ç›®çš„ç›®å½•å¦‚ä¸‹
 
 ```
 react-ts-template/
  README.md
  node_modules/
  package.json
  public/
    index.html
    favicon.ico
  src/
    App.css
    App.tsx
    App.test.tsx
    index.css
    demo.ts
    logo.svg
  .gitignore
  images.d.ts  
  package.json
  package-lock.json
  README.md
  tsconfig.json
  tsconfig.prod.json
  tsconfig.test.json
  tslint.json
 ```
 
 å¦‚æœå‡ºç°æŠ¥é”™ç­‰ä¿¡æ¯ï¼Œå¯ä»¥å…ˆçœ‹çœ‹è‡ªå·±çš„ç½‘ç»œæ˜¯å¦æ­£å¸¸ï¼Œä¸è¡Œå¼€ä¸ªçƒ­ç‚¹è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿›ä¸€æ­¥æ’æŸ¥é—®é¢˜ï¼Œæ¬¢è¿æ¢è®¨ã€‚
 
 æ³¨æ„ï¼š
 
 - `tsconfig.json`, `tsconfig.prod.json`, `tsconfig.test.json`, `tslint.json` åŒ…æ‹¬äº†tsæ–¹é¢çš„ä¸œè¥¿ï¼Œä½ å¯ä»¥æš‚æ—¶ä¸ç”¨ç®¡å®ƒï¼Œæˆ‘ä»¬æ‰«ä¸€çœ¼ `package.json` é‡Œé¢çš„ `scripts`é€‰é¡¹å°±å¯ä»¥äº†ã€‚

 - `public` åŒ…å«äº†åŒ…å«äº†é™æ€èµ„æºå¦‚HTMLé¡µé¢æˆ–å›¾ç‰‡ã€‚`src` åŒ…å«äº†xé¡¹ç›®çš„æºç ã€‚`demo.ts` æ˜¯å…¥å£æ–‡ä»¶, å½“ç„¶ä½ ä¹Ÿå¯é€šè¿‡ `package.json` é‡Œé¢çš„ `main` å­—æ®µè¿›è¡Œå¤„ç†ã€‚

### åˆæ¬¡å°è¯•

é¦–å…ˆé€šè¿‡å‘½ä»¤å°†é¡¹ç›®è¿›è¡Œå¯åŠ¨ï¼š

```sh
npm run start
```
æ­¤æ—¶æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€ `http://localhost:3000/`, å¦‚æœé‡åˆ°ç«¯å£å ç”¨ï¼Œè¿›è¡Œä¸€ä¸‹å¤„ç†

```sh
# é¦–å…ˆæŸ¥æ‰¾ç«¯å£å ç”¨çš„è¿›ç¨‹
lsof -i tcp:3000
# æ€æ­»è¿›ç¨‹
kill PID
```
å¯åŠ¨æˆåŠŸçš„è¯ï¼Œä¼šçœ‹åˆ°ç†Ÿæ‚‰çš„ Logoï¼Œæ¥ï¼Œæˆ‘ä»¬æç‚¹äº‹æƒ…ï¼Œä¸è¦åˆ«ä»–çš„ç›®å½•å“åˆ°ï¼Œè®°ä½ä¸€ç‚¹ï¼Œçœ‹ä¸€ä¸ªå‰ç«¯é¡¹ç›®ï¼ŒçŸ¥é“å…¥å£ï¼ŒçŸ¥é“è·¯ç”±ï¼Œç¥é©¬éƒ½æ˜¯æµ®äº‘ã€‚

æŠŠå…¥å£é‡Œé¢çš„ä¾èµ–çš„ `css` æ–‡ä»¶å…¨éƒ¨åˆ é™¤ï¼Œé¡¹ç›®å»ºæ„ä¹Ÿåšäº†è°ƒæ•´ï¼Œå¦‚ä¸‹ï¼š

```
react-ts-template/
  README.md
  node_modules/
  package.json
  public/
    index.html
    favicon.ico
  src/
    component/
      Hello/
        demo.ts
        index.css
    App.jsx
    demo.ts
  .gitignore
  images.d.ts  
  package.json
  package-lock.json
  README.md
  tsconfig.json
  tsconfig.prod.json
  tsconfig.test.json
  tslint.json
```

æˆ‘è¿™é‡Œç®€å•å†™äº†ä¸ª `Hello` ç»„ä»¶(`src/component/Hello`)

```typescript
import * as React from 'react';
import './index.css';

export interface Props {
    name: string,
    rangeLevel?: number
}

class Index extends React.Component<Props, object> {
    getExclamationMarks(numChars: number) {
        return Array(numChars + 1).join('!');
    }
    render() {
        const { name, rangeLevel = 1 } = this.props;
        
        if (rangeLevel <= 0) {
            throw new Error('you could be a little more enthusiastic. :D');
        }
        
        return (
            <div className="hello">
                <div className="greeting">
                    { name + this.getExclamationMarks(rangeLevel)}
                </div>
            </div>
        );
    }
}

export default Index;
```
æ­¤æ—¶ä½ å¯ä»¥æŠŠæˆ‘åˆæ¬¡å°è¯•çš„è¿™æ®µä»£ç  `clone` ä¸‹æ¥è¿è¡Œ

æ³¨æ„ï¼šå½“ä½ ä¿®æ”¹åæ‰§è¡Œ `npm run start` ä½ å¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„æŠ¥é”™ 

```
Compile Error: interface name must start with a capitalized
```

æˆ‘ç›®å‰çš„è§£å†³æ–¹æ¡ˆæ˜¯è¿›è¡Œ `tslint.json` ä¿®æ”¹ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

```diff
{
-  "extends": ["tslint:recommended", "tslint-react", "tslint-config-prettier"],
+  "extends": [],
+  "defaultSeverity": "warning",
   "linterOptions": {
     "exclude": [
       "config/**/*.js",
       "node_modules/**/*.ts"
     ]
   }
 }

```

å®˜ç½‘æ­£åœ¨ä¿®å¤æ­¤bugï¼Œå¦‚æœæ­¤æ—¶æœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œæ¬¢è¿æ¢è®¨ï¼Œå…±è¿›æ­¥ã€‚

### åˆæ¬¡å›é¡¾

æ­¤æ—¶æƒ³äº†æƒ³ï¼Œå‘ç°è‡ªå·±æŠŠè‡ªå·±å‘äº†ï¼Œå½“æˆ‘åæœŸæƒ³åšåˆ°æ›´åŠ å®šåˆ¶åŒ–çš„æ‰“åŒ…çš„æ—¶å€™ï¼Œä¸€äº› `config` æˆ–è€…æ˜¯ `package.json` éœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆæˆ‘åœ¨è¿™ä¸ªè„šæ‰‹æ¶æ„å»ºå‡ºæ¥çš„é¡¹ç›®ï¼Œæ²¡çœ‹åˆ°ä»€ä¹ˆå“ªæ–¹é¢çš„ä¸œè¥¿å•Šï¼Œäºæ˜¯æˆ‘æŸ¥çœ‹äº†ä¸‹ `package.json` é‡Œé¢æœ‰ä¸ªç‰¹æ®Šçš„å‘½ä»¤ `eject` ï¼Œå®ƒçš„æ„ä¹‰æ˜¯å¦‚æœæƒ³è¦è‡ªå·±ä¿®æ”¹webpackä¹‹ç±»çš„é…ç½®éœ€è¦æ‰§è¡Œ `npm run eject` å¼¹å‡ºé…ç½®æ–‡ä»¶ï¼Œè¿™ä¸ªæ“ä½œæ˜¯ä¸å¯é€†çš„ï¼Œäºæ˜¯æˆ‘ç›´æ¥æ‰§è¡Œäº† `npm run eject` ï¼Œç„¶åå‡ºæ¥äº†ä¸€äº›æç¤ºï¼Œå¦‚ä¸‹å›¾ï¼š

<img src="./docResources/error_1.jpg" width="500">

äºæ˜¯æˆ‘æŠŠæ–‡ä»¶å…ˆä¸€äº›æ–‡ä»¶å…ˆ `git stash` äº†ï¼Œç„¶åç»§ç»­æ‰§è¡Œ `npm run eject` ï¼ŒæƒŠå–œå‡ºç°äº†ï¼Œé¡¹ç›®ç›®å½•å…ˆå‡ºç°äº† `config` ç›®å½•ï¼Œé‡Œé¢åŒ…æ‹¬å¦‚ä¸‹æ–‡ä»¶ï¼š

<img src="./docResources/configFiles.png" width="500">

åŒæ—¶å‘ç°äº† `package.json` æ–‡ä»¶å‘ç”Ÿäº†å¾ˆå¤§çš„å˜åŒ–ï¼Œé¡¹ç›®æ‰€ä¾èµ–çš„åŒ…éƒ½åˆ—äº†å‡ºæ¥ï¼Œ`eject` è¿™ä¸ªè„šæœ¬å‘½ä»¤ä¹Ÿä¸å­˜åœ¨äº†ï¼Œé‡è¦çš„äº‹æƒ…è¯´ä¸‰æ¬¡ï¼Œé¿å…å‡ºç°ä¾èµ–è¦†ç›–çš„æƒ…å†µï¼š

##### å¦‚æœé¡¹ç›®éœ€è¦ç»“åˆ `create-react-app` è„šæ‰‹æ¶åšå®šåˆ¶åŒ–ï¼Œå°±æœ€å¼€å§‹å°±æ‰§è¡Œ `npm run eject`ã€‚

##### å¦‚æœé¡¹ç›®éœ€è¦ç»“åˆ `create-react-app` è„šæ‰‹æ¶åšå®šåˆ¶åŒ–ï¼Œå°±æœ€å¼€å§‹å°±æ‰§è¡Œ `npm run eject`ã€‚

##### å¦‚æœé¡¹ç›®éœ€è¦ç»“åˆ `create-react-app` è„šæ‰‹æ¶åšå®šåˆ¶åŒ–ï¼Œå°±æœ€å¼€å§‹å°±æ‰§è¡Œ `npm run eject`ã€‚

### ä¾èµ–åŒ…æ‹“å±•

æˆ‘æƒ³äº†æƒ³ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ä¸­å¯èƒ½ä¼šç”¨åˆ° `è·¯ç”±`ï¼Œ`æ•°æ®çŠ¶æ€`ï¼Œäºæ˜¯æˆ‘æ¯«ä¸çŠ¹è±«çš„é€‰æ‹©çš„ç”Ÿæ€ä¸é”™çš„ä¸€ä¸‹ä¾èµ–åŒ…ï¼š

```JSON
	"react-redux": "5.0.5",
    "react-router": "3.0.5",
    "react-router-redux": "^4.0.8"
```

devä¸­ä¾èµ–çš„éƒ¨åˆ†tsç›¸å…³åŒ…

```JSON
	"@types/react-redux": "6.0.9",
    "@types/react-router": "^3.0.5",
    "@types/react-router-redux": "^4.0.48"
```

æ³¨æ„æ­¤å¤„æœ‰å‘ï¼Œä¸ºå•¥å­å‘¢ï¼Œéƒ½çŸ¥é“å‰ç«¯çš„å‘å±•æ˜¯å¾ˆçŒ›çš„ï¼Œå°¤å…¶æ˜¯æŠ€æœ¯çš„è¿­ä»£å’Œå¼€æºå·¥å…·çš„å‡çº§ï¼Œç”šè‡³æœ‰æ—¶å€™å‡ ä¸ªç‰ˆæœ¬ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº†ç¨³ä¸€ç‚¹çš„ è·¯ç”±V3ï¼Œç»“åˆæˆ‘ä»¬ä½¿ç”¨çš„ tsç‰ˆæœ¬(3.0.3) ï¼Œæˆ‘ç¿»é˜…äº†æ–‡æ¡£ æŸ¥çœ‹äº† tsç›¸å…³åŒ…ï¼Œå…·ä½“è§ä¸€ä¸‹åœ°å€

[react-reduxç»“åˆtså¯¹åº”çš„type definitionså‚è€ƒç‰ˆæœ¬](https://www.npmjs.com/package/@types/react-redux)

[react-routerç»“åˆtså¯¹åº”çš„type definitionså‚è€ƒç‰ˆæœ¬](https://www.npmjs.com/package/@types/react-router)

[react-router-reduxç»“åˆtså¯¹åº”çš„type definitionså‚è€ƒç‰ˆæœ¬](https://www.npmjs.com/package/@types/react-router-redux)

è¿™é‡Œï¼Œæˆ‘å¯¹é¡¹ç›®éª¨æ¶åšäº†ç®€å•çš„åˆæ­¥è°ƒæ•´ï¼ŒåæœŸä¼šç»§ç»­ä¼˜åŒ–ï¼Œå…ˆå†™åˆ°è¿™é‡Œã€‚

## é¡¹ç›®è°ƒæ•´

### åˆæ­¥æ€è€ƒ

ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸€å°èŠ‚çš„å­˜åœ¨äº†ï¼Œæˆ‘ç»“åˆå‰ç«¯ç»„ä»¶åŒ–çš„æƒ…å†µï¼Œæ·±å…¥æ€è€ƒäº†ä¸€äº›ï¼Œåœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå‰ç«¯çš„æ•°æ®çŠ¶æ€å¾ˆå¤æ‚ï¼Œä¸åŒçš„ç»„ä»¶æ‹¥æœ‰ä¸åŒçš„çŠ¶æ€ï¼Œä¸åŒçš„é¡µé¢æœ‰ä¸åŒçš„çŠ¶æ€ï¼ŒåŒæ—¶ä¸åŒé¡µé¢ï¼Œå…¬ç”¨ç»„ä»¶ä¹Ÿå¯èƒ½æœ‰ä¸åŒçš„çŠ¶æ€ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œåˆæ˜¯ç»„ä»¶ï¼Œåˆæ˜¯çŠ¶æ€çš„ï¼Œå¦‚æœå¤§å‹é¡¹ç›®æœ‰å¤§å¤§å°å°å¤§å‡ ç™¾çš„ç»„ä»¶ï¼Œä¸Šç™¾çš„é¡µé¢æˆ‘æ˜¯ä¸æ˜¯è¦ç–¯äº†ï¼Œå½“æˆ‘æ”¹ä¸€ä¸ªç»„ä»¶çš„æ—¶å€™æˆ‘è¿˜éœ€è¦å»ä¸€ä¸ªä¸ªçš„æ‰¾æˆ‘çš„çŠ¶æ€å¥¶å®šä¹‰çš„ï¼Œæ„Ÿè§‰å¥½ä¹±ï¼Œå¥½éš¾ç»´æŠ¤ï¼Œäºæ˜¯æˆ‘çš„åˆæ­¥æ€è·¯æ˜¯ï¼Œæˆ‘ä»¬å¯¹äºä¸€ä¸ªé¡µé¢ ç»´æŠ¤ä¸€å¥—çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€å‘¢åŒ…æ‹¬ç»„ä»¶çš„çŠ¶æ€ï¼Œæœ€åé€šè¿‡ä¸€ä¸ªå…¬å…±çš„çŠ¶æ€ç®¡ç†é¡µé¢ï¼Œå°†æ‰€æœ‰çŠ¶æ€é›†ä¸­æ˜ å°„ï¼Œæ˜¯ä¸æ˜¯å¾ˆå®Œç¾ï¼Œè¿™æ ·å­çš„è¯æˆ‘æ‰¾çš„è¯æˆ‘å°±å¾ˆæ–¹ä¾¿çš„å¯ä»¥åœ¨å¯¹åº”çš„é¡µé¢ä¸­æ‰¾åˆ°è‡ªå·±åº”è¯¥ä¿®æ”¹çš„çŠ¶æ€äº†ï¼Œå³ä½¿å¯¹äºä¸ç†Ÿæ‚‰æ•´ä¸ªé¡¹ç›®çš„æ–°äººæ¥è¯´ï¼Œä½ åªéœ€è¦å“ªä¸ªé¡µé¢ä¹Ÿä¸€èˆ¬å¯ä»¥å¤„ç†ä¸€äº›é‡åˆ°çš„é—®é¢˜ï¼Œé‚£ä¹ˆåºŸè¯ä¸å¤šè¯´ï¼Œå¼€å§‹è¡ŒåŠ¨ã€‚ğŸ˜ğŸ˜ğŸ˜

æˆ‘ç®€å•å¯¹é¡¹ç›®çš„ç›®å½•åšäº†è°ƒæ•´ï¼Œæ·»åŠ äº†ä¸€äº›æ¨¡å—ï¼Œç®€å•çœ‹çœ‹ç»“æ„ï¼Œå¦‚ä¸‹ï¼š

```javascript
react-ts-template/
  config           // é¡¹ç›®åŸºæœ¬é…ç½® 
  docResources/    // README.md èµ„æºç›®å½•
  node_modules/    // npm åŒ…
  public/          // é¡¹ç›®æ ¹æ–‡ä»¶
  scripts/         // é¡¹ç›®ç›¸å…³è„šæœ¬
  src/             // æºç ç›®å½•
  	axios/          // è¯·æ±‚å·¥å…·
    components/    // ç»„ä»¶ç›®å½•
    config/        // æºç ç›¸å…³é…ç½®
    filters/       // é¡¹ç›®è¿‡æ»¤å™¨
    lib/           // èµ„æºç›®å½•
    pages/         // é¡µé¢ç›®å½•
    router/        // è·¯ç”±é…ç½®ç›®å½•
    statics/       // é™æ€èµ„æºç›®å½•
    store/         // çŠ¶æ€å­˜å‚¨æ ¹ç›®å½•
    styles/        // æ ·å¼åº“
    utils/         // å·¥å…·æ–‡ä»¶å¤¹
    admin.tsx      // è§„åˆ’åå°ç®¡ç†ç³»ç»Ÿå…¥å£
    index.ts      // é»˜è®¤é¡¹ç›®å…¥å£
  .env             // ç¯å¢ƒé…ç½®æ–‡ä»¶
  .gitignore       // ... åé¢çš„ä¸å¿…å¤šè¯´ï¼Œæˆ‘ä»¬ç»§ç»­
  images.d.ts      // ...
  package.json
  package-lock.json
  README.md
  tsconfig.json
  tsconfig.prod.json
  tsconfig.test.json
  tslint.json     // ...
```

è¯´è¯´æˆ‘è¿™æ ·åˆ’åˆ†ç›®å½•çš„æƒ³æ³•ï¼Œå…¶å®å°±æ˜¯ä¸ºäº†æ–¹ä¾¿åæœŸç»´æŠ¤ï¼Œå°ä¼™ä¼´ä»¬ä¸€çœ‹å°±çŸ¥é“æˆ‘ä»€ä¹ˆä¸œè¥¿ï¼Œåœ¨ä»€ä¹ˆä½ç½®ï¼Œè¿™é‡Œçš„é‡ç‚¹æ˜¯æ•°æ®çŠ¶æ€çš„ç®¡ç†ï¼Œå’Œç»„ä»¶çš„æ­å»ºï¼Œæˆ‘ä»¬å…¬ç”¨ç»„ä»¶æˆ–è€…æ˜¯æ‹“å±•æ€§é«˜çš„ç»„ä»¶(å±•ç¤ºç»„ä»¶)ï¼Œå­˜åœ¨äº components ç›®å½•ä¸‹ï¼ŒåŒæ—¶é¡µé¢ç›®å½•æˆ‘ç®€å•å†™äº†2ä¸ªé¡µé¢çš„ç›®å½• home å’Œ detailï¼Œæˆ‘é‡ç‚¹å¯¹ home ç»“åˆç»„ä»¶è¿›è¡Œäº†codingï¼Œæˆ‘ä»¬æŠŠ å±•ç¤ºç»„ä»¶ å’Œ å®¹å™¨ç»„ä»¶ è¿›è¡Œäº†ç»“åˆï¼Œå¾—ç›Šäº react-reduxï¼Œå¦å¤–å¯¹äºç”¨åˆ°çš„ç»„ä»¶ï¼Œä½ å¯ä»¥é€‰æ‹©è‡ªå·±çš„æ–¹å¼ï¼Œç›´æ¥å¼•å…¥ä½¿ç”¨æˆ–è€…æ˜¯ä½ åœ¨ home ç›®å½•ä¸‹çš„ components ä¸­è¿›è¡ŒäºŒæ¬¡åŒ…è£…ï¼Œç„¶ååœ¨ä½¿ç”¨ï¼Œæ‚„æ‚„é€æ¼ä¸€å¥ï¼Œæˆ‘åé¢ä¼šå¯¹æ²¡ä¸ªç»„ä»¶å‡åä¸€ä¸‹æƒé™çš„ç®¡ç†ï¼Œæ£€éªŒç­‰ï¼Œæ€»æ˜¯éšä¾¿ä½ å‘æŒ¥ã€‚æˆ‘ä»¬æŠŠæ•°æ®çŠ¶æ€çš„ç®¡ç†æ‹†åˆ†åˆ°æ²¡ä¸ªé¡µé¢ï¼ŒåŒæ—¶ç»„ä»¶æœ‰è‡ªå·±å…¨é¢çš„æ•°æ®çŠ¶æ€ï¼Œæœ€åæˆ‘ä»¬ç»Ÿä¸€ combineåˆ°æ ¹çŠ¶æ€ç®¡ç†ä¸­ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥æŸ¥çœ‹æºç ï¼Œä¸€ç›®äº†ç„¶ã€‚

æˆ‘ä¸‹é¢è°ˆè°ˆæˆ‘åœ¨ç»“åˆ TypeScript ä½¿ç”¨çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„å‘ï¼Œè°ˆä¸€ä¸‹æˆ‘åœ¨å¯¹ Hello ç»„ä»¶è¿›è¡Œ Props æ£€éªŒ

```typescript
import { Dispatch } from 'redux';
// import { connect, Dispatch } from 'react-redux';
import { connect } from 'react-redux';

import Hello from '../../../components/Hello'
import * as actions from '../store/actionCreators';
import { StoreState } from '../store/types';

export function mapStateToProps({ demo: { rangeLevel, languageName } }: StoreState) {
    return {
        rangeLevel,
        name: languageName,
    }
}

export function mapDispatchToProps(dispatch: Dispatch<actions.EnthusiasmAction>) {
    return {
        onIncrement: () => dispatch(actions.incrementEnthusiasm()),
        onDecrement: () => dispatch(actions.decrementEnthusiasm()),
    }
}

export function mergeProps(stateProps: Object, dispatchProps: Object, ownProps: Object) {
    return Object.assign({}, ownProps, stateProps, dispatchProps);
}

export default connect(mapStateToProps, mapDispatchToProps, mergeProps)(Hello);

```
æ³¨æ„ï¼š ç¬¬ 2 è¡Œä»£ç ï¼Œæˆ‘æœ€å¼€å§‹è¿™æ ·å­åšçš„ï¼Œå¯æ˜¯ä¸€ç›´æŠ¥é”™ï¼Œè¯´çš„æ˜¯ `react-redux` ä¸­ä¸å­˜åœ¨è¿™ä¸ªæ¨¡å—ï¼Œä¸åº”è¯¥å•Šï¼Œä»¥å‰æˆ‘éƒ½è¿™ä¹ˆç”¨çš„å•Šï¼Œéš¾é“æˆ‘çš„ç¯å¢ƒå‡ºäº†é—®é¢˜å—ï¼Œäºæ˜¯æˆ‘æŸ¥çœ‹äº† `react-redux` çš„ issuesï¼Œæœç„¶åé¢çš„ç‰ˆæœ¬å°±ç§»é™¤äº†è¿™ä¸ªå¯¹è±¡ï¼Œé™„ä¸Š [react-reduxçš„issuesåœ°å€](https://github.com/DefinitelyTyped/DefinitelyTyped/issues/26840)ï¼Œå¦ä¸€ä¸ªæ–¹å¼æ˜¯ç›´æ¥ä» `redux` ä¸­å¯¼å…¥å®Œç¾ä½¿ç”¨ã€‚è¿˜æœ‰ä¸ªé—®é¢˜æ˜¯æˆ‘åœ¨ä½¿ç”¨ `import { combineReducers } from 'redux';` è¿‡ç¨‹ä¸­é‡åˆ°äº†å‘ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œè‡ªå·±æœªè‡ªå·±ä¹°å•ï¼Œ2å±‚ `combineReducers` æˆ‘æ˜¯ä¸€ä¸ªå–œæ¬¢å°è¯•çš„äººï¼Œç»“æœä¸æ–­çš„æŠ¥é”™ï¼Œå¯¼è‡´æˆ‘ä»¬çš„ `Props` æ²¡æœ‰æˆåŠŸæŒ‚è½½åˆ°ç»„ä»¶ä¸Šï¼Œä¸€ç›´è·å–ä¸åˆ°å€¼ï¼Œ`state` æœ‰å€¼ï¼Œä½†æ˜¯ æ²¡æœ‰ `æ–¹æ³•`ï¼Œæ‰€ä»¥ä»¥æ­¤ä¸ºæˆ’ã€‚

### redux-sagaåˆ¨å‘

æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¼‚æ­¥é—®é¢˜å¤æ‚å¤šå˜ï¼Œå¯¹äºå¤§å‹çš„é¡¹ç›®æ›´æ˜¯å¦‚æ­¤ï¼Œç»“åˆæˆ‘ä»¬ç›®å‰ä½¿ç”¨çš„ redux æˆ‘è¿›è¡Œäº†æ€è€ƒï¼Œæˆ‘çš„ç›®æ ‡æ˜¯æ‰“é€ ä»ç®€å•åˆ°å¤æ‚çš„é¡¹ç›®ï¼Œéšç€ä¸€äº›ä¸šåŠ¡çš„å¢åŠ ï¼Œå°¤å…¶æ˜¯åœ¨ä¸€äº› cms ç³»ç»Ÿä¸­æ›´æ˜¯å¤æ‚ï¼Œå¼€å§‹ç¬¬ä¸€ååº”æƒ³åˆ°çš„å¼‚æ­¥æ¨¡å—æ˜¯ ğŸ˜¬ `redux-thunk`ï¼Œä¸ºå•¥å­ï¼Œå› ä¸ºå®ƒæˆæœ¬ä½ï¼Œä»»ä½•äº‹ä¸æ˜¯ä¸¤å…¨çš„ï¼Œä½¿ç”¨ç®€å•çš„åŒæ—¶ï¼Œå¸¦æ¥äº†åæœŸå¤æ‚åº¦æå‡ä¹‹åçš„ç»´æŠ¤æˆæœ¬çš„æé«˜ï¼Œäºæ˜¯æŠ›å¼ƒäº† `redux-thunk`ï¼Œå‡†å¤‡å‘¨æœ«è¸ä¸ŠğŸ˜ƒ `redux-saga` è¿™ä¸ªè¢«äººäººç§°ä¸ºä¸å¥½ç”¨æˆæœ¬é«˜çš„èˆ¹ã€‚

å¯èƒ½å¾ˆå¤šäººæœ‰ä¸ªè¯¯è§£ï¼Œredux-sagaæ˜¯reactçš„ä¸­é—´ä»¶ï¼Œå…¶å®ä¸ç„¶ï¼Œæˆ‘ä»¬ä» [å®˜æ–¹çš„æ–‡æ¡£](https://www.npmjs.com/package/redux-saga) ä¹Ÿå¯ä»¥çŸ¥é“ç‰¹å…¶å®æ˜¯ä»‹äº `redux` çš„ä¸­é—´ä»¶ï¼Œå¯¹äº `redux` çš„ä¸­é—´ä»¶å¤ªå¤šäº†ï¼ŒåŒ…æ‹¬ç»å¸¸ç”¨åˆ°çš„ `redux-logger`(é¡¹ç›®ä¸­æˆ‘ä¼šå¼•å…¥)ï¼Œè¿˜æ˜¯é‚£å¥è¯ï¼Œæˆ‘ä»¬è¦è€ƒè™‘åˆ°ä»¥åé¡¹ç›®å¤§äº†åæ¯ä¸ªé¡µé¢æœ‰å„è‡ªçš„æ•°æ®çŠ¶æ€ï¼ŒåŒæ—¶æ¯ä¸ªç»„ä»¶çº§ä¹Ÿæœ‰è‡ªå·±çš„æ•°æ®çŠ¶æ€ï¼ŒåŒæ—¶æœ‰çš„çŠ¶æ€æ˜¯å…±æœ‰çš„ï¼Œæˆ‘ä»¬å¦‚æœå°†çŠ¶æ€æŸ”åˆ°ä¸€èµ·ï¼Œä»¥åå¾ˆéš¾ç»´æŠ¤ï¼Œå¯¹äºåé¢çš„å°ä¼™ä¼´æ˜¯å‘ï¼Œå½“ç„¶ç»´æŠ¤å’Œé¡¹ç›®å¤æ‚åº¦æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼Œæˆ‘é€‰æ‹©äº†æ˜“äºç»´æŠ¤çš„ï¼Œæˆ‘çš„æ¯ä¸ªå¯¹åº”ç»„ä»¶å’Œé¡µé¢çš„ `redux-saga` ï¼Œæ•°æ®çŠ¶æ€å¯¹åº”åˆ°å¯¹åº”çš„é¡µé¢å±‚çº§ï¼Œæœ€åé€šè¿‡å„æ•°æ®å…¥å£ï¼Œæˆ‘ä»¬å°† `redux` å’Œ `redux-saga` è¿›è¡Œæ±‡èšæ•´åˆï¼Œæ˜¯ä¸æ˜¯å¾ˆå®Œç¾ï¼Œé‚£å°±é©¬ä¸Šå¼€å§‹å§ã€‚

ç»“åˆå®˜ç½‘è¯´æ˜ï¼Œæˆ‘å…ˆåˆè¯•ï¼Œæ‰§è¡Œä»¥ä¸‹è„šæœ¬

```sh
npm install --save redux-saga
```

ç„¶ååœ¨æ ¹ `store` ç›®å½•å»ºç«‹ `sagas.ts` ç”¨äºæ±‡èšæ‰€æœ‰ `sagas`ï¼Œå‚ç…§å®˜ç½‘çš„ ä¸­é—´ä»¶æ³¨å…¥æ–¹å¼è¿›è¡Œäº†å¤„ç†ï¼Œå¦‚ä¸‹ï¼š

```typescript
import { createStore, applyMiddleware } from 'redux';
import createSagaMiddleware from 'redux-saga';
// @ts-ignore
import {createLogger} from 'redux-logger';
import { composeWithDevTools } from 'redux-devtools-extension'

import reducers from './reducer';
import rootSaga from './sagas';

const logger = createLogger();
// åˆ›å»º å¹¶ç»‘å®šsaga ä¸­é—´ä»¶
const sagaMiddleware = createSagaMiddleware();

export default function () {
    const store = createStore(reducers, composeWithDevTools(
        applyMiddleware(logger, sagaMiddleware)
    ));
    // run ä¹‹å‰è¦æŠŠå®‰è£… sagaMiddlewareï¼Œé˜²æ­¢æŠ¥é”™
    sagaMiddleware.run(rootSaga);
    return store;
}

```

å¯¹ `home` é¡µé¢ `store` ç›®å½•è¿›è¡Œè°ƒæ•´ï¼Œå¦‚ä¸‹

```javascript
store/
  actionCreators/
  constants/
  reducers/
  sagas/
     index.ts
  types/
  index.ts
  initState.ts      
```

æˆ‘è¿™é‡Œåœ¨ä»£ç é‡Œé¢åœ¨ç»„ä»¶çº§å’Œé¡µé¢çº§éƒ½ç¤ºä¾‹åˆ° `redux-saga` ,æˆ‘è¿™é‡Œä»è±†ç“£éšä¾¿æ‰¾äº†ä¸€ä¸ªapi ç”¨æ¥æ¨¡æ‹Ÿå¼‚æ­¥ï¼Œç†è§£å¼‚æ­¥å°±è¡Œï¼Œä¸ç”¨çº ç»“ä¸€äº›è¯·æ±‚çš„ç»“æœï¼Œæˆ‘ä»¬å°†æ¥å¼‚æ­¥é€»è¾‘æŠ½è±¡åˆ° `redux-saga` æ–‡ä»¶ï¼Œæ–¹ä¾¿å•å…ƒæµ‹è¯•å’Œå¼‚æ­¥ç»Ÿä¸€ç®¡ç†ï¼Œhomeé¡µé¢çš„ `saga.ts` å¦‚ä¸‹:

```typescript
// import { takeEvery, put, select } from 'redux-saga/effects';
import { takeEvery, put } from 'redux-saga/effects';
import { delay } from 'redux-saga'
import axios from 'axios';

import { USER_FETCH_REQUESTED } from '../constants';
import { userFetchSucceeded, userFetchFailed } from '../actionCreators';

// @ts-ignore
function* getInitList(actionData: Object) {
    try {
        const reqData = actionData['data'] || 1012002;
        yield delay(5000);

        const res = yield axios.get(`https://api.apiopen.top/EmailSearch?number=${reqData}`);
        const action = yield res.data.code === 200 ? userFetchSucceeded(res.data.message) : userFetchFailed(res.data.message);
        yield put(action);
    } catch (e) {
        yield put(userFetchFailed(e.message));
    }
}

export default function* () {
    // æ‹¦æˆªéœ€è¦å¼‚æ­¥çš„ type
    yield takeEvery(USER_FETCH_REQUESTED, getInitList);
    // yield takeEvery('*', function* logger(action) {
    //     const state = yield select();
    //     console.log('action', action);
    //     console.log('state after', state);
    // })
}
```

æˆ‘è¿™é‡Œå°†ä¸€äº›è‡ªæˆ‘æµ‹è¯•è¿‡çš„ä»£ç æ³¨é‡Šï¼Œä½ å¯ä»¥å¿½ç•¥ï¼Œå½“ç„¶ä½ æ”¾å¼€æ³¨é‡Šä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œçš„

æˆ‘ä»¬å¯¹ constants/index.ts è¿›è¡Œäº†è°ƒæ•´ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªå¼‚æ­¥çš„è¯·æ±‚ï¼ŒæˆåŠŸ(`USER_FETCH_SUCCEEDED`)å’Œå¤±è´¥(`USER_FETCH_FAILED`)è¿›è¡Œäº†æ‹†åˆ†ï¼Œå…¶ä¸­å‘èµ·è¯·æ±‚(`USER_FETCH_REQUESTED `)çš„ä¸ºå¦‚ä¸‹ï¼š

```typescript
// constant
export const INCREMENT_ENTHUSIASM = 'INCREMENT_ENTHUSIASM';
export type INCREMENT_ENTHUSIASM = typeof INCREMENT_ENTHUSIASM;

export const DECREMENT_ENTHUSIASM = 'DECREMENT_ENTHUSIASM';
export type DECREMENT_ENTHUSIASM = typeof DECREMENT_ENTHUSIASM;

export const USER_FETCH_REQUESTED = 'USER_FETCH_REQUESTED';
export type USER_FETCH_REQUESTED = typeof USER_FETCH_REQUESTED;


export const USER_FETCH_SUCCEEDED = 'USER_FETCH_SUCCEEDED';
export type USER_FETCH_SUCCEEDED = typeof USER_FETCH_SUCCEEDED;

export const USER_FETCH_FAILED = 'USER_FETCH_FAILED';
export type USER_FETCH_FAILED = typeof USER_FETCH_FAILED;
```

æˆ‘ä»¬è°ƒæ•´ actionCreators/index.tsï¼Œæ³¨æ„è¿™é‡Œé¢æˆ‘ä»¬éœ€è¦æŠŠ ç»„ä»¶æˆ–è€…é¡µé¢ç”¨åˆ°çš„ `action` é›†åˆä¸‹ï¼Œä»¥ä¾¿ç”¨äº å®¹å™¨ç»„ä»¶å’Œé¡µé¢çº§çš„ `reducer ` ï¼Œé˜²æ­¢ `typescript ` æŠ¥é”™

```typescript
import * as constants from '../constants'

export interface IncrementEnthusiasm {
    type: constants.INCREMENT_ENTHUSIASM;
}

export interface DecrementEnthusiasm {
    type: constants.DECREMENT_ENTHUSIASM;
}

export interface GetInitList {
    type: constants.USER_FETCH_REQUESTED;
    data: number
}
// redux-saga ç§æœ‰
// export interface InitListAction {
//     type: constants.INIT_LIST_ACTION;
//     data: number
// }


export interface UserFetchSucceeded {
    type: constants.USER_FETCH_SUCCEEDED;
    message: string
}
export interface UserFetchFailed {
    type: constants.USER_FETCH_FAILED;
    message: string
}

// ç»„ä»¶çº§
export type EnthusiasmAction = IncrementEnthusiasm | DecrementEnthusiasm | GetInitList | UserFetchSucceeded | UserFetchFailed;

// é¡µé¢çº§
export type homePageAction = GetInitList | UserFetchSucceeded | UserFetchFailed;

// ç»„ä»¶çº§ + é¡µé¢çº§ æ±‡æ€»
export type homePageActions = IncrementEnthusiasm | DecrementEnthusiasm | GetInitList | UserFetchSucceeded | UserFetchFailed;



export function incrementEnthusiasm(): IncrementEnthusiasm {
    return {
        type: constants.INCREMENT_ENTHUSIASM
    }
}

export function decrementEnthusiasm(): DecrementEnthusiasm {
    return {
        type: constants.DECREMENT_ENTHUSIASM
    }
}
// redux-sage å¼‚æ­¥è°ƒç”¨
export function getInitList(data: number):GetInitList {
    return {
        type: constants.USER_FETCH_REQUESTED,
        data: data
    }
}

export function userFetchSucceeded(message: string): UserFetchSucceeded {
    return {
        type: constants.USER_FETCH_SUCCEEDED,
        message
    }
}
export function userFetchFailed(message: string): UserFetchFailed {
    return {
        type: constants.USER_FETCH_FAILED,
        message
    }
}
```
ç„¶åå¼€å§‹ reducers/index.ts

```typescript
import update from 'react-addons-update';

// å¯¼å‡ºä¸º å½“å‰é¡µé¢action çš„é›†åˆ
import { homePageActions } from '../actionCreators';
import defaultState from '../types';
import initState from '../initState';
import { INCREMENT_ENTHUSIASM,
    DECREMENT_ENTHUSIASM,
    USER_FETCH_SUCCEEDED,
    USER_FETCH_FAILED
} from '../constants';

export function pageReducers(state = initState,
                             action: homePageActions): defaultState {

    switch (action.type) {
        case INCREMENT_ENTHUSIASM:
            // return { ...state, state.demo.rangeLevel: state.demo.rangeLevel! + 1 };
            return update(state, {
                helloData: {
                    rangeLevel: {
                        $set: state.helloData.rangeLevel + 1
                    }
                }
            })
        case DECREMENT_ENTHUSIASM:
            return update(state, {
                helloData: {
                    rangeLevel: {
                        $set: state.helloData.rangeLevel - 1
                    }
                }
            })
        // saga work åç»­å¤„ç†
        case USER_FETCH_SUCCEEDED:
            return update(state, {
                homeData: {
                    data: {
                        $set: action.message
                    }
                }
            })
        case USER_FETCH_FAILED:
            return update(state, {
                homeData: {
                    data: {
                        $set: action.message
                    }
                }
            })
    }
    return state;
}
```
è¿™é‡Œæˆ‘é‡åˆ°ä¸€ä¸ªå‘ï¼Œå°±æ˜¯å¯¹è±¡è¿”å›çš„æ—¶å€™ï¼Œtsæ€»æ˜¯ç»™æˆ‘æŠ¥é”™ï¼Œå¯¹äºè¿”å› `newState` æœ‰ä¸€å®šå†²çªçš„åœ°æ–¹ï¼Œæˆ‘è¿™é‡Œæœ€åˆçš„å¤„ç†æ–¹å¼æ˜¯ä½¿ç”¨ `react-addons-update` åŸæœ‰çš„æ–¹å¼å·²ç»ä¸å†ä½¿ç”¨ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªè‡ªå·±çš„åˆå¹¶æ–¹æ³•ã€‚

åˆ«å¿˜è®°äº†æˆ‘ä»¬çš„ types/index.ts å’Œ initState.ts ä¹Ÿè¦åŒæ­¥ä¸‹ï¼Œå¯ä»¥ç»“åˆè‡ªå·±çš„æƒ…å†µè¿›è¡Œæ•°æ®æ ‘çš„åˆ’åˆ†ã€‚è¿™é‡Œæˆ‘å°±ä¸ç²˜è´´ä»£ç äº†ï¼Œå¤§å®¶å¯ä»¥æºç çœ‹åˆ°ã€‚

æˆ‘åœ¨æ ¹ç›®å½•çš„ store/sagas.ts è¿›è¡Œäº†codeï¼Œå¦‚ä¸‹

```typescript
import { all, fork } from 'redux-saga/effects';

// å¯¼å…¥ç›¸å…³é¡µé¢çš„ store
import homeStore from '../pages/home/store';

export default function* rootSaga() {
    yield all([
        fork(homeStore.sagas),
        // å…¶ä»–é¡µé¢ sagasï¼Œæ•°ç»„å½¢å¼
    ])
}
```

è¿™é‡Œè¯´æ˜ä¸‹ `all` å¯ä»¥å¯¹ saga è¿›è¡Œé›†åˆï¼Œä»¥ä¸ºæ•°ç»„çš„å½¢å¼è¿›è¡Œä¹¦å†™ï¼Œforkæ–¹æ³•å¯ä»¥æ— é˜»èµ›çš„å¼‚æ­¥æ“ä½œï¼Œè¾¾åˆ°è‰¯å¥½çš„ä½“éªŒã€‚

æˆ‘åœ¨ç»„ä»¶çº§åˆ«è¿›è¡Œäº† `redux-saga` ä½¿ç”¨ï¼Œä½¿ç”¨stateæ—¶ä¸€å®šè¦æ³¨æ„è‡ªå·±çš„æ•°æ®ç»“æ„

```typescript
// https://github.com/DefinitelyTyped/DefinitelyTyped/issues/26840
import { Dispatch } from 'redux';
import { connect } from 'react-redux';

import Hello from '../../../components/Hello'
import * as actions from '../store/actionCreators';
import { helloState } from '../store/types';
// import { Props } from '../components/Hello/index';

// å¯¹äºä½¿ç”¨çš„ç»„ä»¶æ‰€åœ¨çš„é¡µé¢ï¼Œè¯·æŒ‰ç…§æ•°æ®æ ‘çš„è§£æ„è¿›è¡Œè§£æ„ï¼Œæ­¤å‡ºhome ä»£è¡¨homeé¡µé¢
export function mapStateToProps({ home: {
    helloData: { rangeLevel, languageName, data }
}}: { home: helloState }) {
    return {
        rangeLevel,
        name: languageName,
        data,
    }
}

export function mapDispatchToProps(dispatch: Dispatch<actions.EnthusiasmAction>) {
    return {
        onIncrement: () => dispatch(actions.incrementEnthusiasm()),
        onDecrement: () => dispatch(actions.decrementEnthusiasm()),
        onGetInitList: (data: number) => dispatch(actions.getInitList(data)),
    }
}

export function mergeProps(stateProps: Object, dispatchProps: Object, ownProps: Object) {
    return Object.assign({}, ownProps, stateProps, dispatchProps);
}

export default connect(mapStateToProps, mapDispatchToProps, mergeProps)(Hello);

// export default connect<Props>(mapStateToProps, mapDispatchToProps)(Hello);

```
ä¸‹é¢æ˜¯æˆ‘åœ¨é¡µé¢çº§è¿›è¡Œäº†ä½¿ç”¨ï¼ŒåŒæ ·ç»“åˆè‡ªå·±çš„stateç»“æ„ï¼Œå¦‚æœæ„Ÿè§‰å¤æ‚ï¼Œå¯ä»¥æŸ¥çœ‹tools

```typescript
import * as React from 'react';
import { Dispatch } from 'redux';
import { connect } from 'react-redux';
// å¼•å…¥é¡µé¢ç›¸å…³ç»„ä»¶ ...
import Hello from './components/Hello';
import * as actions from "./store/actionCreators";

// é¡µé¢å¸ƒå±€æ ·å¼
import * as styles from './style.less';
import { homeState } from "./store/types";

export interface Props {
    data: string;
    onGetInitList?: (data: number) => void;
}

class Home extends React.PureComponent<Props, {}> {
    render() {
      const { data } = this.props;
      return (
          <div>
              <Hello name='TypeScript' />
              <div className={styles.pageName}>{ data }</div>
          </div>
      )
    }
    componentDidMount() {
        // const { data } = this.props;
        // console.log(data);
    }
}

export function mapStateToProps({ home: {
    homeData: { data }
}}: { home: homeState }) {
    return {
        data
    }
}

export function mapDispatchToProps(dispatch: Dispatch<actions.homePageAction>) {
    return {
        onGetInitList: (data: number) => dispatch(actions.getInitList(data)),
    }
}

export function mergeProps(stateProps: Object, dispatchProps: Object, ownProps: Object) {
    return Object.assign({}, ownProps, stateProps, dispatchProps);
}


export default connect(mapStateToProps, mapDispatchToProps, mergeProps)(Home);

```

æ³¨æ„åœ¨é¡µé¢çº§çš„ `reducer` ä¸­ï¼Œä»–æ‰€æ¥å—çš„stateå’Œæˆ‘ä»¬è®¤ä¸ºstateçŠ¶æ€æ ‘æ˜¯æœ‰å·®åˆ«çš„ï¼Œä»– home è¿™æ ·çš„æ ‡è¯†ï¼Œå¦‚æœ‰ä»¥ä¸ºå…ˆæ‰“å°logï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å’Œæˆ‘ä¸€èµ·æ¢è®¨ã€‚ğŸ˜ƒ


### å¼•å…¥cssæ¨¡å—æœºåˆ¶

ä¸ºäº†ç†è§£cssæ¨¡å—åŒ–æ€æƒ³ï¼Œæˆ‘ä»¬é¦–å…ˆäº†è§£ä¸‹ï¼Œä»€ä¹ˆæ˜¯æ¨¡å—åŒ–ï¼Œåœ¨ç™¾åº¦ç™¾ç§‘ä¸Šçš„è§£é‡Šæ˜¯ï¼Œåœ¨ç³»ç»Ÿçš„ç»“æ„ä¸­ï¼Œæ¨¡å—æ˜¯å¯ç»„åˆã€åˆ†è§£å’Œæ›´æ¢çš„å•å…ƒã€‚æ¨¡å—åŒ–æ˜¯ä¸€ç§å¤„ç†å¤æ‚ç³»ç»Ÿåˆ†è§£æˆä¸ºæ›´å¥½çš„å¯ç®¡ç†æ¨¡å—çš„æ–¹å¼ã€‚å®ƒå¯ä»¥é€šè¿‡åœ¨ä¸åŒç»„ä»¶è®¾å®šä¸åŒçš„åŠŸèƒ½ï¼ŒæŠŠä¸€ä¸ªé—®é¢˜åˆ†è§£æˆå¤šä¸ªå°çš„ç‹¬ç«‹ã€äº’ç›¸ä½œç”¨çš„ç»„ä»¶ï¼Œæ¥å¤„ç†å¤æ‚ã€å¤§å‹çš„è½¯ä»¶ã€‚çœ‹å®Œæ¨¡å—åŒ–ï¼Œæ˜¯ä¸æ˜¯æœ‰ç§æ‹¼å›¾çš„å³è§†æ„Ÿï¼Œå¯ä»¥æŠŠå¤§å›¾åˆ†æˆå„ä¸ªå°å›¾ï¼Œç„¶åæŠŠå°å›¾æ‹¼æˆå¤§å›¾ï¼Œåˆ†ä¸åˆçš„è‰ºæœ¯æ„Ÿã€‚é‚£ä¹ˆcssæ¨¡å—åŒ–æ€æƒ³ï¼Œä¹Ÿå°±æ˜¯åœ¨cssç¼–å†™ç¯å¢ƒä¸­ï¼Œç”¨ä¸Šæ¨¡å—åŒ–çš„æ€æƒ³ï¼ŒæŠŠä¸€ä¸ªå¤§çš„é¡¹ç›®ï¼Œåˆ†è§£æˆç‹¬ç«‹çš„ç»„ä»¶ï¼Œä¸åŒçš„ç»„ä»¶è´Ÿè´£ä¸åŒçš„åŠŸèƒ½ï¼Œæœ€åæŠŠæ¨¡å—ç»„è£…ï¼Œå°±æˆäº†æˆ‘ä»¬è¦å®Œæˆçš„é¡¹ç›®äº†ã€‚

#### cssæ¨¡å—åŒ–æœ‰ä»€ä¹ˆå¥½å¤„

1. æé«˜ä»£ç é‡ç”¨ç‡
2. æé«˜å¼€å‘æ•ˆç‡ã€å‡å°‘æ²Ÿé€šæˆæœ¬
3. æé«˜é¡µé¢å®¹é”™
4. é™ä½è€¦åˆ
5. é™ä½å‘å¸ƒé£é™©
6. å‡å°‘Bugå®šä½æ—¶é—´å’ŒFixæˆæœ¬
7. æ›´å¥½çš„å®ç°å¿«é€Ÿè¿­ä»£
8. ä¾¿äºä»£ç ç»´æŠ¤

CSS æ¨¡å—åŒ–çš„è§£å†³æ–¹æ¡ˆæœ‰å¾ˆå¤šï¼Œä½†ä¸»è¦æœ‰ä¸¤ç±»ã€‚ä¸€ç±»æ˜¯å½»åº•æŠ›å¼ƒ CSSï¼Œä½¿ç”¨ JS æˆ– JSON æ¥å†™æ ·å¼ã€‚Radiumï¼Œjsxstyleï¼Œreact-style å±äºè¿™ä¸€ç±»ã€‚ä¼˜ç‚¹æ˜¯èƒ½ç»™ CSS æä¾› JS åŒæ ·å¼ºå¤§çš„æ¨¡å—åŒ–èƒ½åŠ›ï¼›ç¼ºç‚¹æ˜¯ä¸èƒ½åˆ©ç”¨æˆç†Ÿçš„ CSS é¢„å¤„ç†å™¨ï¼ˆæˆ–åå¤„ç†å™¨ï¼‰ Sass/Less/PostCSSï¼Œ:hover å’Œ :active ä¼ªç±»å¤„ç†èµ·æ¥å¤æ‚ã€‚å¦ä¸€ç±»æ˜¯ä¾æ—§ä½¿ç”¨ CSSï¼Œä½†ä½¿ç”¨ JS æ¥ç®¡ç†æ ·å¼ä¾èµ–ï¼Œä»£è¡¨æ˜¯ CSS Modulesã€‚CSS Modules èƒ½æœ€å¤§åŒ–åœ°ç»“åˆç°æœ‰ CSS ç”Ÿæ€å’Œ JS æ¨¡å—åŒ–èƒ½åŠ›ï¼ŒAPI ç®€æ´åˆ°å‡ ä¹é›¶å­¦ä¹ æˆæœ¬ã€‚å‘å¸ƒæ—¶ä¾æ—§ç¼–è¯‘å‡ºå•ç‹¬çš„ JS å’Œ CSSã€‚å®ƒå¹¶ä¸ä¾èµ–äº Reactï¼Œåªè¦ä½ ä½¿ç”¨ Webpackï¼Œå¯ä»¥åœ¨ Vue/Angular/jQuery ä¸­ä½¿ç”¨ã€‚æ˜¯æˆ‘è®¤ä¸ºç›®å‰æœ€å¥½çš„ CSS æ¨¡å—åŒ–è§£å†³æ–¹æ¡ˆã€‚

è¿™é‡Œæˆ‘å¯¹ `*.css` å’Œ `*.less` æ–‡ä»¶è¿›è¡Œæ¨¡å—åŒ–

```sh
npm install --save-dev typings-for-css-modules-loader
```

é…ç½® webpack æ–‡ä»¶ï¼Œé’ˆå¯¹ `*.css` è¿™é‡Œæ²¡æœ‰ç”¨ css-loader ï¼Œç”¨ `typings-for-css-modules-loader` ä»£æ›¿

```javascript
{
            test: /\.css$/,
            use: [
              require.resolve('style-loader'),
              // {
              //   loader: require.resolve('css-loader'),
              //   options: {
              //     importLoaders: 1,
              //   },
              // },
              {
                loader: 'typings-for-css-modules-loader',
                options: {
                  modules: true,
                  namedExport: true
                }
              },
              {
                loader: require.resolve('postcss-loader'),
                options: {
                  // Necessary for external CSS imports to work
                  // https://github.com/facebookincubator/create-react-app/issues/2677
                  ident: 'postcss',
                  plugins: () => [
                    require('postcss-flexbugs-fixes'),
                    autoprefixer({
                      browsers: [
                        '>1%',
                        'last 4 versions',
                        'Firefox ESR',
                        'not ie < 9', // React doesn't support IE8 anyway
                      ],
                      flexbox: 'no-2009',
                    }),
                  ],
                },
              },
            ],
          },
```

é’ˆå¯¹ less 

```javascript
{
            test: /\.less$/,
            use: [
              require.resolve('style-loader'),
              {
                loader: require.resolve('css-loader'),
                options: {
                  importLoaders: 1,
                  modules: true,
                  localIdentName: '[name]__[local]__[hash:base64:5]', //
                },
              },
              // {
              //   loader: 'typings-for-css-modules-loader',
              //   options: {
              //     modules: true,
              //     namedExport: true
              //   }
              // },
              {
                loader: require.resolve('postcss-loader'),
                options: {
                  // Necessary for external CSS imports to work
                  // https://github.com/facebookincubator/create-react-app/issues/2677
                  ident: 'postcss',
                  plugins: () => [
                    require('postcss-flexbugs-fixes'),
                    autoprefixer({
                      browsers: [
                        '>1%',
                        'last 4 versions',
                        'Firefox ESR',
                        'not ie < 9', // React doesn't support IE8 anyway
                      ],
                      flexbox: 'no-2009',
                    }),
                  ],
                },
              },
              {
                loader: require.resolve('less-loader')
              }
            ],
          },
```
å¦å¤–ï¼Œæˆ‘åœ¨é¡¹ç›®ä¸­å»ºäº†ä¸ªæ–‡ä»¶ src/declaration/externals.d.tsï¼Œé˜²æ­¢ ts æŠ¥é”™

```typescript
declare module '*.less'
declare module '*.css'
```
åœ¨ `tsconfig.json` è¿›è¡Œå¢åŠ é…ç½®

```javascript
"includes": [
    "./src/declaration/externals.d.ts"
  ],
```
è‡³æ­¤ï¼ŒåŸºæœ¬æ“ä½œå®Œæˆï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ¨¡å—åŒ–çš„å†™æ³•äº†ã€‚

### TypeScriptçš„åæ€

å†™ç€å†™ç€ï¼Œæˆ‘æ„Ÿè§‰è‡ªå·±çš„ `Ts` å†™çš„æœ‰ç‚¹ä¹±ï¼Œé‚£ä¹ˆæˆ‘åœä¸‹æ¥ï¼Œå°†å¯¹å…¶è¿›è¡ŒåŸºäºæ¶æ„ä¸Šçš„å¾®è°ƒæ•´ï¼Œæä¾›ä¼˜è´¨ä»£ç ã€‚

#### å…³äºtsçš„ä¸€äº›è°ƒæ•´

å‰ç«¯æ—¶é—´ä¸€ç›´åœ¨åšé¡¹ç›®ï¼Œç°åœ¨ç©ºå‡ºæ—¶é—´ï¼Œå…·ä½“è°ƒæ•´å¦‚ä¸‹ï¼š

1.tsçš„æ ¡éªŒè§„åˆ™è¿›è¡Œäº†å¾ˆå¤§çš„å˜åŠ¨ï¼Œå…·ä½“å˜åŠ¨æˆ‘å°±ä¸åˆ—ä¸¾äº†ï¼Œä½ å¯ä»¥å‚è€ƒ `tslint.json`ï¼Œå¦å¤–æ³¨æ„ä¸€ä¸‹ `tsconfig.prod.json` è§„åˆ™æ–‡ä»¶

```json
{
  "extends": "./tsconfig.json",
  "compilerOptions": {
    "sourceMap": false
  }
}
```
2.æ·±åŒ–åˆå§‹åŒ–æ•°æ®è§„åˆ™ï¼Œé’ˆå¯¹ `initState.ts` ä¸­æ•°æ®è¿›è¡Œæ•°æ®çº¦æŸï¼Œå¦‚ä¸‹ï¼š

```typescript
import {IHelloState, IHomeState} from './types/index'
export const helloData: IHelloState['helloData'] = {
    rangeLevel: 1,
    languageName: 'TypeScript',
    data: ''
}

export const homeData: IHomeState['homeData'] = {
    data: ''
}

export default {
    helloData,
    homeData
}
```
3.å°†æ¥ä¸€äº›å¼‚æ­¥ç½‘ç»œè¯·æ±‚çš„é€»è¾‘è¿›è¡Œäº†æ‹†åˆ†(sagaä¸­åˆ†ç¦»)

```javascript
react-ts-template/
  src/             // æºç ç›®å½•
    utils/			// å·¥å…·æ–‡ä»¶å¤¹	
    	api.ts       // å­˜æ”¾è¯·æ±‚åœ°å€
    	http.ts      // å­˜æ”¾ç½‘è·¯è¯·æ±‚çš„åŸºæœ¬é…ç½®
    	index.ts.    // å­˜æ”¾å¸¸ç”¨å·¥å…·å‡½æ•°
    services/	      // è¯·æ±‚äºŒçº§è®¾ç½®(åŒ…æ‹¬äºŒçº§è®¾ç½®ï¼Œåœ°å€ï¼Œè¯·æ±‚æ–¹å¼)   
```
4.è€ƒè™‘åˆ°ä¸€äº›æ ·å¼çš„è®¾ç½®(æœ‰äº›éœ€æ±‚éœ€è¦antdçš„æ ·å¼è¦†ç›–ï¼Œæˆ–è€…ç±»åè®¾ç½®)ï¼Œæˆ‘ä»¬ä¸èƒ½å®Œå…¨æŠŠæ‰€æœ‰çš„styleç»™æ¨¡å—åŒ–äº†ï¼Œæœªæ­¤æˆ‘å°† `.less` å¼•å…¥çš„æ–‡ä»¶æˆ‘ä»¬è¿›è¡Œåˆå§‹åŒ–ï¼Œè€Œ `.css` ä¸ºæˆ‘ä»¬é¢„ç•™çš„æ´»å£ï¼Œçµæ´»ä½¿ç”¨ï¼Œä¸€å¥è¯ï¼Œèƒ½ç”¨ `.less` å°±ç”¨ `.less` ,å®åœ¨ç”¨ä¸äº†å†ç”¨ `.css`

5.æˆ‘å¯¹ç¤ºä¾‹çš„æ ·å¼è¿›è¡Œäº†è°ƒæ•´ï¼Œå’Œæ–‡å­—è¯´æ˜ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒè¯´æ˜ï¼Œè‡ªè¡Œ clone ï¼Œç„¶åè¿›è¡Œæµ‹è¯•ï¼Œä½¿ç”¨

6.é’ˆå¯¹æ‰“åŒ…æœºåˆ¶è¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ç”Ÿäº§ç¯å¢ƒè¿›è¡Œäº†å¤„ç†ï¼Œå¯¹æœ‰çš„æš‚æ—¶ç”¨ä¸åˆ°çš„åŠŸèƒ½å’Œå†—ä½™çš„æ–‡ä»¶è¿›è¡Œäº†åˆ é™¤ï¼Œä»¥ä¿è¯æ›´åŠ ç®€æ´çš„çº¿ä¸Šä»£ç 

### åé¢çš„è¯

ğŸ˜¬å†™åˆ°è¿™é‡Œï¼ŒåŸºæœ¬å·®ä¸å¤šå†™å®Œäº†ï¼Œå†™çš„ä¸å¥½ï¼Œå¤šå¤šæŒ‡æ•™ï¼ŒåæœŸæˆ‘ä¼šå‡ºä¸€äº›å…³äºå‰ç«¯æœåŠ¡ç«¯ `node` çš„ä¸€äº›åšå®¢ï¼Œè¯·å¤§å®¶æŒç»­å…³æ³¨ã€‚














 